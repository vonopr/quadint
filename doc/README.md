# Четырехугольная интерполяция

Билинейная интерполяция позволяет отобразить значения $f_{1,2,3,4}$, заданные  в вершинах прямоугольника, на внутренность этого прямоугольника $1243$ с помощью преобразования
$$
\hat{f}(x,y) = f_1 \frac{ (x_{+}-x)(y_{+}-y)}{(x_{+}-x_{-})(y_{+}-y_{-})} +
f_2 \frac{(x-x_{-})(y_{+}-y)}{(x_{+}-x_{-})(y_{+}-y_{-})} +\\
+f_3 \frac{(x_{+}-x)(y-y_{-})}{(x_{+}-x_{-})(y_{+}-y_{-})} +
f_4 \frac{(x-x_{-})(y-y_{-})}{(x_{+}-x_{-})(y_{+}-y_{-})},
$$
где $x_{-}\equiv x_1=x_3$, $x_{+} \equiv x_2=x_4$,  $y_{-} \equiv y_1=y_2$,  $y_{+} \equiv y_3=y_4$ ,  $(x_n,y_n)$ - координаты вершин.

Что делать, если значения заданы в узлах произвольного четырехугольника? В этом случае можно использовать четырехугольную интерполяцию [[1]](https://math.stackexchange.com/questions/2007116/quadrilateral-interpolation). Это обобщение билинейной интерполяции на случай произвольного выпуклого четырехугольника.

## Билинейное преобразование четырехугольника
Даны  вершины выпуклого четырехугольника $1243$  с координатами `(x,y)` и значения величины `f` в каждой из точек. Требуется интерполировать значения величины в некоторую точку 0 с координатами `(x0,y0)` внутри четырехугольника 1234.

```ascii
                     2
                   X                                
    1 
     X                    3
                        X
    X
   4
```

Рассмотрим преобразование $\varphi (\alpha, \beta)$ при $\alpha, \beta \in [-\frac12;\frac12]$
$$ 
\varphi(\alpha, \beta) =
   \varphi_1 \left( 1/2-\alpha \right)  \left( 1/2-\beta \right) +
   \varphi_2 \left( 1/2+\alpha \right)  \left( 1/2-\beta \right) + \\
   \varphi_3 \left( 1/2-\alpha \right)  \left( 1/2+\beta \right) + 
   \varphi_4 \left( 1/2+\alpha \right)  \left( 1/2+\beta \right),
$$
где $\varphi_n$ - значение $x,y$ или $f$ в точке  $n=1,2,3$ или $4$.

Преобразование $\varphi$ примененное к координатам $(x,y)$ точек четырехугольника преобразует его в квадрат$[-\frac12;\frac12] \times [-\frac12;\frac12]$.

```ascii

    1       2
     X - - X
     |     |
     |     |
     X - - X
    3       4
   ```



Удобно отобразить четырехугольник 1234 в квадрат с помощью некого удобного нам преобразования `f(x,y)`.

## Ссылки
[1] https://math.stackexchange.com/questions/2007116/quadrilateral-interpolation
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTI2OTQ0OTQzN119
-->